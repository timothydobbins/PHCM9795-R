<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Sample size | PHCM9795 Foundations of Biostatistics</title>
  <meta name="description" content="Chapter 10 Sample size | PHCM9795 Foundations of Biostatistics" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Sample size | PHCM9795 Foundations of Biostatistics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Sample size | PHCM9795 Foundations of Biostatistics" />
  
  
  

<meta name="author" content="Notes for R" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="analysing-non-normal-data.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">PHCM9795 Foundations of Biostatistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Introduction to R and RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#learning-outcomes"><i class="fa fa-check"></i>Learning outcomes</a></li>
<li class="chapter" data-level="1.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#r-vs-rstudio"><i class="fa fa-check"></i><b>1.2</b> R vs RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#installing-r-and-rsudio"><i class="fa fa-check"></i><b>1.3</b> Installing R and RSudio</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#simpleR"><i class="fa fa-check"></i><b>1.4</b> A simple R analysis</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#the-rstudio-environment"><i class="fa fa-check"></i><b>1.5</b> The RStudio environment</a></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#some-r-basics"><i class="fa fa-check"></i><b>1.6</b> Some R basics</a></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#part-2-obtaining-basic-descriptive-statistics"><i class="fa fa-check"></i><b>1.7</b> Part 2: Obtaining basic descriptive statistics</a></li>
<li class="chapter" data-level="1.8" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#defning-categorical-variables-as-factors"><i class="fa fa-check"></i><b>1.8</b> Defning categorical variables as factors</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#part-3-creating-other-types-of-graphs"><i class="fa fa-check"></i>Part 3: Creating other types of graphs</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html"><i class="fa fa-check"></i><b>2</b> Probability and probability distributions: R notes</a>
<ul>
<li class="chapter" data-level="2.1" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#importing-data-into-stata"><i class="fa fa-check"></i><b>2.1</b> Importing data into Stata</a></li>
<li class="chapter" data-level="2.2" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#checking-your-data-for-errors-in-stata"><i class="fa fa-check"></i><b>2.2</b> Checking your data for errors in Stata</a></li>
<li class="chapter" data-level="2.3" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#overlaying-a-normal-curve-on-a-histogram"><i class="fa fa-check"></i><b>2.3</b> Overlaying a Normal curve on a histogram</a></li>
<li class="chapter" data-level="2.4" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#ggplot2"><i class="fa fa-check"></i><b>2.4</b> ggplot2</a></li>
<li class="chapter" data-level="2.5" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#descriptive-statistics-for-checking-normality"><i class="fa fa-check"></i><b>2.5</b> Descriptive statistics for checking normality</a></li>
<li class="chapter" data-level="2.6" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#import-excel"><i class="fa fa-check"></i><b>2.6</b> Importing Excel data into Stata</a></li>
<li class="chapter" data-level="2.7" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#generating-new-variables"><i class="fa fa-check"></i><b>2.7</b> Generating new variables</a></li>
<li class="chapter" data-level="2.8" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#summarising-data-by-another-variable"><i class="fa fa-check"></i><b>2.8</b> Summarising data by another variable</a></li>
<li class="chapter" data-level="2.9" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#recoding-data"><i class="fa fa-check"></i><b>2.9</b> Recoding data</a></li>
<li class="chapter" data-level="2.10" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#computing-binomial-probabilities-using-r"><i class="fa fa-check"></i><b>2.10</b> Computing binomial probabilities using R</a></li>
<li class="chapter" data-level="2.11" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#computing-probabilities-from-a-normal-distribution"><i class="fa fa-check"></i><b>2.11</b> Computing probabilities from a Normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="precision-r-notes.html"><a href="precision-r-notes.html"><i class="fa fa-check"></i><b>3</b> Precision: R notes</a>
<ul>
<li class="chapter" data-level="3.1" data-path="precision-r-notes.html"><a href="precision-r-notes.html#calculating-a-95-confidence-interval-of-a-mean"><i class="fa fa-check"></i><b>3.1</b> Calculating a 95% confidence interval of a mean</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>4</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="4.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-sample-t-test"><i class="fa fa-check"></i><b>4.1</b> One sample t-test</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="comparing-two-means.html"><a href="comparing-two-means.html"><i class="fa fa-check"></i><b>5</b> Comparing two means</a>
<ul>
<li class="chapter" data-level="5.1" data-path="comparing-two-means.html"><a href="comparing-two-means.html#checking-data-for-the-independent-samples-t-test"><i class="fa fa-check"></i><b>5.1</b> Checking data for the independent samples t-test</a></li>
<li class="chapter" data-level="5.2" data-path="comparing-two-means.html"><a href="comparing-two-means.html#independent-samples-t-test"><i class="fa fa-check"></i><b>5.2</b> Independent samples t-test</a></li>
<li class="chapter" data-level="5.3" data-path="comparing-two-means.html"><a href="comparing-two-means.html#checking-the-assumptions-for-a-paired-t-test"><i class="fa fa-check"></i><b>5.3</b> Checking the assumptions for a Paired t-test</a></li>
<li class="chapter" data-level="5.4" data-path="comparing-two-means.html"><a href="comparing-two-means.html#paired-t-test"><i class="fa fa-check"></i><b>5.4</b> Paired t-Test</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="proportions.html"><a href="proportions.html"><i class="fa fa-check"></i><b>6</b> Proportions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="proportions.html"><a href="proportions.html#confidence-intervals-for-proportions"><i class="fa fa-check"></i><b>6.1</b> 95% confidence intervals for proportions</a></li>
<li class="chapter" data-level="6.2" data-path="proportions.html"><a href="proportions.html#significance-test-for-single-proportion"><i class="fa fa-check"></i><b>6.2</b> Significance test for single proportion</a></li>
<li class="chapter" data-level="6.3" data-path="proportions.html"><a href="proportions.html#computing-a-relative-risk-and-its-95-confidence-interval"><i class="fa fa-check"></i><b>6.3</b> Computing a relative risk and its 95% confidence interval</a></li>
<li class="chapter" data-level="6.4" data-path="proportions.html"><a href="proportions.html#computing-an-odds-ratio-and-its-95ci"><i class="fa fa-check"></i><b>6.4</b> Computing an odds ratio and its 95%CI</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="testing-proportions.html"><a href="testing-proportions.html"><i class="fa fa-check"></i><b>7</b> Testing proportions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="testing-proportions.html"><a href="testing-proportions.html#pearsons-chi-squared-test"><i class="fa fa-check"></i><b>7.1</b> Pearson’s chi-squared test</a></li>
<li class="chapter" data-level="7.2" data-path="testing-proportions.html"><a href="testing-proportions.html#chi-squared-test-for-tables-larger-than-2-by-2"><i class="fa fa-check"></i><b>7.2</b> Chi-squared test for tables larger than 2-by-2</a></li>
<li class="chapter" data-level="7.3" data-path="testing-proportions.html"><a href="testing-proportions.html#mcnemars-test-for-paired-proportions"><i class="fa fa-check"></i><b>7.3</b> McNemar’s test for paired proportions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="correlation-and-simple-linear-regression.html"><a href="correlation-and-simple-linear-regression.html"><i class="fa fa-check"></i><b>8</b> Correlation and simple linear regression</a>
<ul>
<li class="chapter" data-level="8.1" data-path="correlation-and-simple-linear-regression.html"><a href="correlation-and-simple-linear-regression.html#creating-a-scatter-plot"><i class="fa fa-check"></i><b>8.1</b> Creating a scatter plot</a></li>
<li class="chapter" data-level="8.2" data-path="correlation-and-simple-linear-regression.html"><a href="correlation-and-simple-linear-regression.html#calculating-a-correlation-coefficient"><i class="fa fa-check"></i><b>8.2</b> Calculating a correlation coefficient</a></li>
<li class="chapter" data-level="8.3" data-path="correlation-and-simple-linear-regression.html"><a href="correlation-and-simple-linear-regression.html#fitting-a-simple-linear-regression-model"><i class="fa fa-check"></i><b>8.3</b> Fitting a simple linear regression model</a></li>
<li class="chapter" data-level="8.4" data-path="correlation-and-simple-linear-regression.html"><a href="correlation-and-simple-linear-regression.html#plotting-residuals-from-a-simple-linear-regression"><i class="fa fa-check"></i><b>8.4</b> Plotting residuals from a simple linear regression</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html"><i class="fa fa-check"></i><b>9</b> Analysing non-normal data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#transforming-non-normally-distributed-variables"><i class="fa fa-check"></i><b>9.1</b> Transforming non-normally distributed variables</a></li>
<li class="chapter" data-level="9.2" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#wilcoxon-ranked-sum-test"><i class="fa fa-check"></i><b>9.2</b> Wilcoxon ranked-sum test</a></li>
<li class="chapter" data-level="9.3" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#wilcoxon-matched-pairs-signed-rank-test"><i class="fa fa-check"></i><b>9.3</b> Wilcoxon matched-pairs signed-rank test</a></li>
<li class="chapter" data-level="9.4" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#estimating-rank-correlation-coefficients"><i class="fa fa-check"></i><b>9.4</b> Estimating rank correlation coefficients</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sample-size.html"><a href="sample-size.html"><i class="fa fa-check"></i><b>10</b> Sample size</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sample-size.html"><a href="sample-size.html#sample-size-calculation-for-two-independent-samples-t-test"><i class="fa fa-check"></i><b>10.1</b> Sample size calculation for two independent samples t-test</a></li>
<li class="chapter" data-level="10.2" data-path="sample-size.html"><a href="sample-size.html#sample-size-calculation-for-difference-between-two-independent-proportions"><i class="fa fa-check"></i><b>10.2</b> Sample size calculation for difference between two independent proportions</a></li>
<li class="chapter" data-level="10.3" data-path="sample-size.html"><a href="sample-size.html#sample-size-calculation-with-a-relative-risk"><i class="fa fa-check"></i><b>10.3</b> Sample size calculation with a relative risk</a></li>
<li class="chapter" data-level="10.4" data-path="sample-size.html"><a href="sample-size.html#sample-size-calculation-with-an-odds-ratio"><i class="fa fa-check"></i><b>10.4</b> Sample size calculation with an odds ratio</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PHCM9795 Foundations of Biostatistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sample-size" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Sample size<a href="sample-size.html#sample-size" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Many power and sample size procedures are available in the <code>epiR</code> package.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="sample-size.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If not yet installed, submit the following:</span></span>
<span id="cb109-2"><a href="sample-size.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;epiR&quot;)</span></span>
<span id="cb109-3"><a href="sample-size.html#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(epiR)</span></code></pre></div>
<div id="sample-size-calculation-for-two-independent-samples-t-test" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Sample size calculation for two independent samples t-test<a href="sample-size.html#sample-size-calculation-for-two-independent-samples-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To do the problem discussed in Worked Example 10.2, we use the <code>epi.sscompc</code> function: <strong>Sample size, power and minimum detectable difference when comparing continuous outcomes</strong>.</p>
<pre><code>epi.sscompc(treat, control, n, sigma, power, 
   r = 1, design = 1, sided.test = 2, nfractional = FALSE, conf.level = 0.95)</code></pre>
<p>The first line contains parameters that we can specify, with one parameter that is to be calculated. That is, we define values for four of the five parameters, and the remaining parameter is calculated. For example, we can define the mean in the treated group, the mean in the control group, the assumed standard deviation and the desired power, and the function will calculate the required sample size. We specify the unknown value as being equal to R’s missing value, <code>NA</code>.</p>
<p>For example, to calculate the required sample size in Worked Example 10.2, we specify:</p>
<ul>
<li>the assumed mean in the experimental, or treatment, group: 90mmHg</li>
<li>the assumed mean in the control group: 95mmHg</li>
<li>the standard deviation of blood pressure: 5mmHg</li>
<li>the required power, 0.9 (representing 90%)</li>
</ul>
<p>The values on the second line of the function are defined by default, and we can leave these as default.</p>
<p>Putting this all together, and specifying the sample size as unknown:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="sample-size.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.sscompc</span>(<span class="at">treat=</span><span class="dv">90</span>, <span class="at">control=</span><span class="dv">95</span>, <span class="at">n=</span><span class="cn">NA</span>, <span class="at">sigma=</span><span class="dv">5</span>, <span class="at">power=</span><span class="fl">0.9</span>) </span>
<span id="cb111-2"><a href="sample-size.html#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.total</span></span>
<span id="cb111-3"><a href="sample-size.html#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 44</span></span>
<span id="cb111-4"><a href="sample-size.html#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb111-5"><a href="sample-size.html#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.treat</span></span>
<span id="cb111-6"><a href="sample-size.html#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 22</span></span>
<span id="cb111-7"><a href="sample-size.html#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb111-8"><a href="sample-size.html#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.control</span></span>
<span id="cb111-9"><a href="sample-size.html#cb111-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 22</span></span>
<span id="cb111-10"><a href="sample-size.html#cb111-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb111-11"><a href="sample-size.html#cb111-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $power</span></span>
<span id="cb111-12"><a href="sample-size.html#cb111-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.9</span></span>
<span id="cb111-13"><a href="sample-size.html#cb111-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb111-14"><a href="sample-size.html#cb111-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $delta</span></span>
<span id="cb111-15"><a href="sample-size.html#cb111-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 5</span></span></code></pre></div>
<p>The results indicate that we need 22 participants in each group, or 44 in total.</p>
<p>We can define whether we want unequal numbers in each group by specifying <code>r</code>: the number in the treatment group divided by the number in the control group.</p>
</div>
<div id="sample-size-calculation-for-difference-between-two-independent-proportions" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Sample size calculation for difference between two independent proportions<a href="sample-size.html#sample-size-calculation-for-difference-between-two-independent-proportions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To do the problem discussed in Worked Example 10.3, we use the <code>epi.sscohortc</code> function: <strong>Sample size, power or minimum detectable incidence risk ratio for a cohort study using individual count data</strong>.</p>
<pre><code>epi.sscohortc(irexp1, irexp0, pexp = NA, n = NA, power = 0.80, 
   r = 1, N, design = 1, sided.test = 2, finite.correction = FALSE, 
   nfractional = FALSE, conf.level = 0.95)</code></pre>
<p>We can enter:</p>
<ul>
<li>irexp1: the assumed risk of the outcome in the exposed group: here 0.35</li>
<li>irexp0: the assumed risk of the outcome in the unexposed group: here 0.2</li>
<li>n: the total sample size, to be determined</li>
<li>power: the required power: here 0.8 (representing 80%)</li>
</ul>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="sample-size.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.sscohortc</span>(<span class="at">irexp1=</span><span class="fl">0.35</span>, <span class="at">irexp0=</span><span class="fl">0.2</span>, <span class="at">n=</span><span class="cn">NA</span>, <span class="at">power=</span><span class="fl">0.8</span>) </span>
<span id="cb113-2"><a href="sample-size.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.total</span></span>
<span id="cb113-3"><a href="sample-size.html#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 276</span></span>
<span id="cb113-4"><a href="sample-size.html#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb113-5"><a href="sample-size.html#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.exp1</span></span>
<span id="cb113-6"><a href="sample-size.html#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 138</span></span>
<span id="cb113-7"><a href="sample-size.html#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb113-8"><a href="sample-size.html#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.exp0</span></span>
<span id="cb113-9"><a href="sample-size.html#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 138</span></span>
<span id="cb113-10"><a href="sample-size.html#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb113-11"><a href="sample-size.html#cb113-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $power</span></span>
<span id="cb113-12"><a href="sample-size.html#cb113-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.8</span></span>
<span id="cb113-13"><a href="sample-size.html#cb113-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb113-14"><a href="sample-size.html#cb113-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $irr</span></span>
<span id="cb113-15"><a href="sample-size.html#cb113-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.75</span></span>
<span id="cb113-16"><a href="sample-size.html#cb113-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb113-17"><a href="sample-size.html#cb113-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $or</span></span>
<span id="cb113-18"><a href="sample-size.html#cb113-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2.153846</span></span></code></pre></div>
<p>Note: It doesn’t matter if you swap the proportions for the <strong>exposed</strong> and <strong>unexposed</strong> groups, i.e. the command <code>epi.sscohortc(irexp1=0.2, irexp0=0.35, n=NA, power=0.8)</code> gives the same results.</p>
</div>
<div id="sample-size-calculation-with-a-relative-risk" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Sample size calculation with a relative risk<a href="sample-size.html#sample-size-calculation-with-a-relative-risk" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>epiR</code> package does not have a function to estimate sample size and power directly for a relative risk, but we can use the <code>epi.sscohortc</code> function.</p>
</div>
<div id="sample-size-calculation-with-an-odds-ratio" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Sample size calculation with an odds ratio<a href="sample-size.html#sample-size-calculation-with-an-odds-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can use the <code>epi.sscc</code> function to calculate a sample size based on an odds ratio in a case-control study:</p>
<pre><code>epi.sscc(OR, p1 = NA, p0, n, power, r = 1, 
   phi.coef = 0, design = 1, sided.test = 2, nfractional = FALSE, 
   conf.level = 0.95, method = &quot;unmatched&quot;, fleiss = FALSE)</code></pre>
<p>Using information from Worked Example 10.4, we specify:</p>
<ul>
<li>OR: the odds ratio to be detected, here 1.5</li>
<li>p0: the proportion of the outcome in the controls, here 0.5</li>
<li>n: the sample size, here to be calculated</li>
<li>power: the required study power, here 0.9</li>
</ul>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="sample-size.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.sscc</span>(<span class="at">OR=</span><span class="fl">1.5</span>, <span class="at">p0=</span><span class="fl">0.5</span>, <span class="at">n=</span><span class="cn">NA</span>, <span class="at">power=</span><span class="fl">0.9</span>)</span>
<span id="cb115-2"><a href="sample-size.html#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.total</span></span>
<span id="cb115-3"><a href="sample-size.html#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1038</span></span>
<span id="cb115-4"><a href="sample-size.html#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb115-5"><a href="sample-size.html#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.case</span></span>
<span id="cb115-6"><a href="sample-size.html#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 519</span></span>
<span id="cb115-7"><a href="sample-size.html#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb115-8"><a href="sample-size.html#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.control</span></span>
<span id="cb115-9"><a href="sample-size.html#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 519</span></span>
<span id="cb115-10"><a href="sample-size.html#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb115-11"><a href="sample-size.html#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $power</span></span>
<span id="cb115-12"><a href="sample-size.html#cb115-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.9</span></span>
<span id="cb115-13"><a href="sample-size.html#cb115-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb115-14"><a href="sample-size.html#cb115-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $OR</span></span>
<span id="cb115-15"><a href="sample-size.html#cb115-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.5</span></span></code></pre></div>
<p>Now we calculate the sample size for Worked Example 10.5:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="sample-size.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.sscc</span>(<span class="at">OR=</span><span class="dv">2</span>, <span class="at">p0=</span><span class="fl">0.3</span>, <span class="at">n=</span><span class="cn">NA</span>, <span class="at">power=</span><span class="fl">0.9</span>)</span>
<span id="cb116-2"><a href="sample-size.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.total</span></span>
<span id="cb116-3"><a href="sample-size.html#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 376</span></span>
<span id="cb116-4"><a href="sample-size.html#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb116-5"><a href="sample-size.html#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.case</span></span>
<span id="cb116-6"><a href="sample-size.html#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 188</span></span>
<span id="cb116-7"><a href="sample-size.html#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb116-8"><a href="sample-size.html#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.control</span></span>
<span id="cb116-9"><a href="sample-size.html#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 188</span></span>
<span id="cb116-10"><a href="sample-size.html#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb116-11"><a href="sample-size.html#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $power</span></span>
<span id="cb116-12"><a href="sample-size.html#cb116-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.9</span></span>
<span id="cb116-13"><a href="sample-size.html#cb116-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb116-14"><a href="sample-size.html#cb116-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $OR</span></span>
<span id="cb116-15"><a href="sample-size.html#cb116-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>Here we see that we require a total of 376 participants to detect an odds ratio of 2.0 with 90% power;</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="sample-size.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.sscc</span>(<span class="at">OR=</span><span class="dv">2</span>, <span class="at">p0=</span><span class="fl">0.3</span>, <span class="at">n=</span><span class="cn">NA</span>, <span class="at">power=</span><span class="fl">0.8</span>)</span>
<span id="cb117-2"><a href="sample-size.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.total</span></span>
<span id="cb117-3"><a href="sample-size.html#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 282</span></span>
<span id="cb117-4"><a href="sample-size.html#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb117-5"><a href="sample-size.html#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.case</span></span>
<span id="cb117-6"><a href="sample-size.html#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 141</span></span>
<span id="cb117-7"><a href="sample-size.html#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb117-8"><a href="sample-size.html#cb117-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $n.control</span></span>
<span id="cb117-9"><a href="sample-size.html#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 141</span></span>
<span id="cb117-10"><a href="sample-size.html#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb117-11"><a href="sample-size.html#cb117-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $power</span></span>
<span id="cb117-12"><a href="sample-size.html#cb117-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.8</span></span>
<span id="cb117-13"><a href="sample-size.html#cb117-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb117-14"><a href="sample-size.html#cb117-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $OR</span></span>
<span id="cb117-15"><a href="sample-size.html#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>or a total of 282 participants to detect an odds ratio of 2.0 with 80% power.</p>

<div id="refs" class="references csl-bib-body hanging-indent">
<div class="csl-entry">
Therneau, Terry M., and Patricia M. Grambsch. 2010. <em>Modeling <span>Survival Data</span>: <span>Extending</span> the <span>Cox Model</span></em>. <span>New York Berlin Heidelberg</span>: <span>Springer</span>.
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="analysing-non-normal-data.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/10.1-sample-size-R.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["phcm9795-R-notes.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
