<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 2 Probability and probability distributions: R notes | PHCM9795 Foundations of Biostatistics</title>
  <meta name="description" content="Module 2 Probability and probability distributions: R notes | PHCM9795 Foundations of Biostatistics" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 2 Probability and probability distributions: R notes | PHCM9795 Foundations of Biostatistics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 2 Probability and probability distributions: R notes | PHCM9795 Foundations of Biostatistics" />
  
  
  

<meta name="author" content="Pilot Notes for R" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-r-and-rstudio.html"/>
<link rel="next" href="precision-r-notes.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">PHCM9795 Foundations of Biostatistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Introduction to R and RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#learning-outcomes"><i class="fa fa-check"></i>Learning outcomes</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#part-1-an-introduction-to-r"><i class="fa fa-check"></i>Part 1: An introduction to R</a></li>
<li class="chapter" data-level="1.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#r-vs-rstudio"><i class="fa fa-check"></i><b>1.1</b> R vs RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>1.2</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#recommended-setup"><i class="fa fa-check"></i><b>1.3</b> Recommended setup</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#simpleR"><i class="fa fa-check"></i><b>1.4</b> A simple R analysis</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#the-rstudio-environment"><i class="fa fa-check"></i><b>1.5</b> The RStudio environment</a></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#some-r-basics"><i class="fa fa-check"></i><b>1.6</b> Some R basics</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#part-2-obtaining-basic-descriptive-statistics"><i class="fa fa-check"></i>Part 2: Obtaining basic descriptive statistics</a></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#set-up-your-data"><i class="fa fa-check"></i><b>1.7</b> Set up your data</a></li>
<li class="chapter" data-level="1.8" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#reading-a-data-file"><i class="fa fa-check"></i><b>1.8</b> Reading a data file</a></li>
<li class="chapter" data-level="1.9" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#summarising-continuous-variables"><i class="fa fa-check"></i><b>1.9</b> Summarising continuous variables</a></li>
<li class="chapter" data-level="1.10" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#producing-a-histogram"><i class="fa fa-check"></i><b>1.10</b> Producing a histogram</a></li>
<li class="chapter" data-level="1.11" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#producing-a-boxplot"><i class="fa fa-check"></i><b>1.11</b> Producing a boxplot</a></li>
<li class="chapter" data-level="1.12" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#producing-a-one-way-frequency-table"><i class="fa fa-check"></i><b>1.12</b> Producing a one-way frequency table</a></li>
<li class="chapter" data-level="1.13" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#defining-categorical-variables-as-factors"><i class="fa fa-check"></i><b>1.13</b> Defining categorical variables as factors</a></li>
<li class="chapter" data-level="1.14" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#saving-data-in-r"><i class="fa fa-check"></i><b>1.14</b> Saving data in R</a></li>
<li class="chapter" data-level="1.15" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#copying-output-from-r"><i class="fa fa-check"></i><b>1.15</b> Copying output from R</a></li>
<li class="chapter" data-level="1.16" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#task"><i class="fa fa-check"></i><b>1.16</b> Task</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#part-3-creating-other-types-of-graphs"><i class="fa fa-check"></i>Part 3: Creating other types of graphs</a></li>
<li class="chapter" data-level="1.17" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#bar-graphs"><i class="fa fa-check"></i><b>1.17</b> Bar graphs</a></li>
<li class="chapter" data-level="1.18" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#creating-line-graphs"><i class="fa fa-check"></i><b>1.18</b> Creating line graphs</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html"><i class="fa fa-check"></i><b>2</b> Probability and probability distributions: R notes</a>
<ul>
<li class="chapter" data-level="2.1" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#importing-data-into-stata"><i class="fa fa-check"></i><b>2.1</b> Importing data into Stata</a></li>
<li class="chapter" data-level="2.2" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#checking-your-data-for-errors-in-r"><i class="fa fa-check"></i><b>2.2</b> Checking your data for errors in R</a></li>
<li class="chapter" data-level="2.3" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#overlaying-a-normal-curve-on-a-histogram"><i class="fa fa-check"></i><b>2.3</b> Overlaying a Normal curve on a histogram</a></li>
<li class="chapter" data-level="2.4" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#ggplot2"><i class="fa fa-check"></i><b>2.4</b> ggplot2</a></li>
<li class="chapter" data-level="2.5" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#descriptive-statistics-for-checking-normality"><i class="fa fa-check"></i><b>2.5</b> Descriptive statistics for checking normality</a></li>
<li class="chapter" data-level="2.6" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#import-excel"><i class="fa fa-check"></i><b>2.6</b> Importing Excel data into Stata</a></li>
<li class="chapter" data-level="2.7" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#generating-new-variables"><i class="fa fa-check"></i><b>2.7</b> Generating new variables</a></li>
<li class="chapter" data-level="2.8" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#summarising-data-by-another-variable"><i class="fa fa-check"></i><b>2.8</b> Summarising data by another variable</a></li>
<li class="chapter" data-level="2.9" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#recoding-data"><i class="fa fa-check"></i><b>2.9</b> Recoding data</a></li>
<li class="chapter" data-level="2.10" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#computing-binomial-probabilities-using-r"><i class="fa fa-check"></i><b>2.10</b> Computing binomial probabilities using R</a></li>
<li class="chapter" data-level="2.11" data-path="probability-and-probability-distributions-r-notes.html"><a href="probability-and-probability-distributions-r-notes.html#computing-probabilities-from-a-normal-distribution"><i class="fa fa-check"></i><b>2.11</b> Computing probabilities from a Normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="precision-r-notes.html"><a href="precision-r-notes.html"><i class="fa fa-check"></i><b>3</b> Precision: R notes</a>
<ul>
<li class="chapter" data-level="3.1" data-path="precision-r-notes.html"><a href="precision-r-notes.html#calculating-a-95-confidence-interval-of-a-mean"><i class="fa fa-check"></i><b>3.1</b> Calculating a 95% confidence interval of a mean</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>4</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="4.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-sample-t-test"><i class="fa fa-check"></i><b>4.1</b> One sample t-test</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="comparing-two-means.html"><a href="comparing-two-means.html"><i class="fa fa-check"></i><b>5</b> Comparing two means</a>
<ul>
<li class="chapter" data-level="5.1" data-path="comparing-two-means.html"><a href="comparing-two-means.html#checking-data-for-the-independent-samples-t-test"><i class="fa fa-check"></i><b>5.1</b> Checking data for the independent samples t-test</a></li>
<li class="chapter" data-level="5.2" data-path="comparing-two-means.html"><a href="comparing-two-means.html#independent-samples-t-test"><i class="fa fa-check"></i><b>5.2</b> Independent samples t-test</a></li>
<li class="chapter" data-level="5.3" data-path="comparing-two-means.html"><a href="comparing-two-means.html#checking-the-assumptions-for-a-paired-t-test"><i class="fa fa-check"></i><b>5.3</b> Checking the assumptions for a Paired t-test</a></li>
<li class="chapter" data-level="5.4" data-path="comparing-two-means.html"><a href="comparing-two-means.html#paired-t-test"><i class="fa fa-check"></i><b>5.4</b> Paired t-Test</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="proportions.html"><a href="proportions.html"><i class="fa fa-check"></i><b>6</b> Proportions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="proportions.html"><a href="proportions.html#confidence-intervals-for-proportions"><i class="fa fa-check"></i><b>6.1</b> 95% confidence intervals for proportions</a></li>
<li class="chapter" data-level="6.2" data-path="proportions.html"><a href="proportions.html#significance-test-for-single-proportion"><i class="fa fa-check"></i><b>6.2</b> Significance test for single proportion</a></li>
<li class="chapter" data-level="6.3" data-path="proportions.html"><a href="proportions.html#computing-a-relative-risk-and-its-95-confidence-interval"><i class="fa fa-check"></i><b>6.3</b> Computing a relative risk and its 95% confidence interval</a></li>
<li class="chapter" data-level="6.4" data-path="proportions.html"><a href="proportions.html#computing-an-odds-ratio-and-its-95ci"><i class="fa fa-check"></i><b>6.4</b> Computing an odds ratio and its 95%CI</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="testing-proportions.html"><a href="testing-proportions.html"><i class="fa fa-check"></i><b>7</b> Testing proportions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="testing-proportions.html"><a href="testing-proportions.html#pearsons-chi-squared-test"><i class="fa fa-check"></i><b>7.1</b> Pearson’s chi-squared test</a></li>
<li class="chapter" data-level="7.2" data-path="testing-proportions.html"><a href="testing-proportions.html#chi-squared-test-for-tables-larger-than-2-by-2"><i class="fa fa-check"></i><b>7.2</b> Chi-squared test for tables larger than 2-by-2</a></li>
<li class="chapter" data-level="7.3" data-path="testing-proportions.html"><a href="testing-proportions.html#mcnemars-test-for-paired-proportions"><i class="fa fa-check"></i><b>7.3</b> McNemar’s test for paired proportions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="correlation-and-simple-linear-regression.html"><a href="correlation-and-simple-linear-regression.html"><i class="fa fa-check"></i><b>8</b> Correlation and simple linear regression</a>
<ul>
<li class="chapter" data-level="8.1" data-path="correlation-and-simple-linear-regression.html"><a href="correlation-and-simple-linear-regression.html#creating-a-scatter-plot"><i class="fa fa-check"></i><b>8.1</b> Creating a scatter plot</a></li>
<li class="chapter" data-level="8.2" data-path="correlation-and-simple-linear-regression.html"><a href="correlation-and-simple-linear-regression.html#calculating-a-correlation-coefficient"><i class="fa fa-check"></i><b>8.2</b> Calculating a correlation coefficient</a></li>
<li class="chapter" data-level="8.3" data-path="correlation-and-simple-linear-regression.html"><a href="correlation-and-simple-linear-regression.html#fitting-a-simple-linear-regression-model"><i class="fa fa-check"></i><b>8.3</b> Fitting a simple linear regression model</a></li>
<li class="chapter" data-level="8.4" data-path="correlation-and-simple-linear-regression.html"><a href="correlation-and-simple-linear-regression.html#plotting-residuals-from-a-simple-linear-regression"><i class="fa fa-check"></i><b>8.4</b> Plotting residuals from a simple linear regression</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html"><i class="fa fa-check"></i><b>9</b> Analysing non-normal data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#transforming-non-normally-distributed-variables"><i class="fa fa-check"></i><b>9.1</b> Transforming non-normally distributed variables</a></li>
<li class="chapter" data-level="9.2" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#wilcoxon-ranked-sum-test"><i class="fa fa-check"></i><b>9.2</b> Wilcoxon ranked-sum test</a></li>
<li class="chapter" data-level="9.3" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#wilcoxon-matched-pairs-signed-rank-test"><i class="fa fa-check"></i><b>9.3</b> Wilcoxon matched-pairs signed-rank test</a></li>
<li class="chapter" data-level="9.4" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#estimating-rank-correlation-coefficients"><i class="fa fa-check"></i><b>9.4</b> Estimating rank correlation coefficients</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sample-size.html"><a href="sample-size.html"><i class="fa fa-check"></i><b>10</b> Sample size</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sample-size.html"><a href="sample-size.html#sample-size-calculation-for-two-independent-samples-t-test"><i class="fa fa-check"></i><b>10.1</b> Sample size calculation for two independent samples t-test</a></li>
<li class="chapter" data-level="10.2" data-path="sample-size.html"><a href="sample-size.html#sample-size-calculation-for-difference-between-two-independent-proportions"><i class="fa fa-check"></i><b>10.2</b> Sample size calculation for difference between two independent proportions</a></li>
<li class="chapter" data-level="10.3" data-path="sample-size.html"><a href="sample-size.html#sample-size-calculation-with-a-relative-risk"><i class="fa fa-check"></i><b>10.3</b> Sample size calculation with a relative risk</a></li>
<li class="chapter" data-level="10.4" data-path="sample-size.html"><a href="sample-size.html#sample-size-calculation-with-an-odds-ratio"><i class="fa fa-check"></i><b>10.4</b> Sample size calculation with an odds ratio</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PHCM9795 Foundations of Biostatistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="probability-and-probability-distributions-r-notes" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Module 2</span> Probability and probability distributions: R notes<a href="probability-and-probability-distributions-r-notes.html#probability-and-probability-distributions-r-notes" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="importing-data-into-stata" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Importing data into Stata<a href="probability-and-probability-distributions-r-notes.html#importing-data-into-stata" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have described previously how to import data that have been saved as R .rds files. It is quite common to have data saved in other file types, such as Microsoft Excel, or plain text files. In this section, we will demonstrate how to import data from other packages into R.</p>
<p>There are two useful packages for importing data into R: <code>haven</code> (for data that have been saved by Stata, SAS or SPSS) and <code>readxl</code> (for data saved by Microsoft Excel). Additionally, the <code>labelled</code> package is useful in working with data that have been labelled in Stata. Here, we will open a dataset that has been stored as a Stata data file (which has the .dta suffix):</p>
<div id="importing-plain-text-data-into-r" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Importing plain text data into R<a href="probability-and-probability-distributions-r-notes.html#importing-plain-text-data-into-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A <code>csv</code> file, or a “comma separated variables” file is commonly used to store data. These files have a very simple structure: they are plain text files, where data are separated by commas. csv files have the advantage that, as they are plain text files, they can be opened by a large number of programs (such as Notepad in Windows, TextEdit in MacOS, Microsoft Excel - even Microsoft Word). While they can be opened by Microsoft Excel, they can be opened by many other programs: the csv file can be thought of as the lingua-franca of data.</p>
<p>In this demonstration, we will use data on the weight of 1000 people entered in a csv file called <code>weight_s2.csv</code> available on Moodle.</p>
<p>To confirm that the file is readable by any text editor, here are the first ten lines of the file, opened in Notepad on Microsoft Windows, and TextEdit on MacOS.</p>
<p><img src="img/mod02/import-01.png" width="66%" /></p>
<p>We can use the <code>read.csv</code> function:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="probability-and-probability-distributions-r-notes.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jmv)</span>
<span id="cb38-2"><a href="probability-and-probability-distributions-r-notes.html#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="probability-and-probability-distributions-r-notes.html#cb38-3" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/examples/Weight_s2.csv&quot;</span>)</span></code></pre></div>
<p>Here, the <code>read.csv</code> function has the default that the first row of the dataset contains the variable names. If your data do not have column names, you can use <code>header=FALSE</code> in the function.</p>
<p>Note: there is an alternative function <code>read_csv</code> which is part of the <code>readr</code> package (a component of the <code>tidyverse</code>). Some would argue that the <code>read_csv</code> function is more appropriate to use because of an issue known as <code>strings.as.factors</code>. The <code>strings.as.factors</code> default was removed in R Version 4.0.0, so it is less important which of the two functions you use to import a <code>.csv</code> file. More information about this issue can be found <a href="https://simplystatistics.org/posts/2015-07-24-stringsasfactors-an-unauthorized-biography">here</a> and <a href="https://developer.r-project.org/Blog/public/2020/02/16/stringsasfactors/">here</a>.</p>
</div>
</div>
<div id="checking-your-data-for-errors-in-r" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Checking your data for errors in R<a href="probability-and-probability-distributions-r-notes.html#checking-your-data-for-errors-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before you start describing and analysing your data, it is important to make sure that no errors have been made during the data entry process. Basically, you are looking for values that are outside the range of possible or plausible values for that variable.</p>
<p>If an error is found, the best method for correcting the error is to go back to the original data e.g. the hard copy questionnaire, to obtain the original value, entering the correct value into R If the original data is not available or the original data is also incorrect, the erroneous value is often excluded from the dataset.</p>
<p>For continuous variables, the easiest methods are to examine a boxplot and histogram. For example, a boxplot and histogram for the weight variable we just imported appear as:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="probability-and-probability-distributions-r-notes.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample<span class="sc">$</span>weight, <span class="at">xlab=</span><span class="st">&quot;Weight (kg)&quot;</span>, <span class="at">main=</span><span class="st">&quot;Histogram of 1000 weights&quot;</span>)</span></code></pre></div>
<p><img src="phcm9795-R-notes_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="probability-and-probability-distributions-r-notes.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(sample<span class="sc">$</span>weight, <span class="at">xlab=</span><span class="st">&quot;Weight (kg)&quot;</span>, <span class="at">main=</span><span class="st">&quot;Boxplot of 1000 weights&quot;</span>)</span></code></pre></div>
<p><img src="phcm9795-R-notes_files/figure-html/unnamed-chunk-46-2.png" width="672" /></p>
<p>There is a clear outlying point shown in the boxplot. Although not obvious, the same point is shown in the histogram as a bar around 700 with a very short height.</p>
<p>We can identify any outlying observations in the dataset using the <code>subset</code> function. You will need to decide if these values are a data entry error or are biologically plausible. If an extreme value or “outlier”, is biologically plausible, it should be included in all analyses.</p>
<p>For example, to list any observations from the <code>sample</code> dataset with a weight larger than 200:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="probability-and-probability-distributions-r-notes.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(sample, weight<span class="sc">&gt;</span><span class="dv">200</span>)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-47">
<caption style="caption-side: top; text-align: center;"><span id="tab:unnamed-chunk-47">Table 2.1: </span> </caption><col><col><tr>
<th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">id</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">weight</th></tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">58</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">700</td></tr>
</table>

<p>We see that there is a very high value of 700.2kg. A value as high as 700kg is likely to be a data entry error (e.g. error in entering an extra zero) and is not a plausible weight value. Here, <strong>you should check your original data</strong>.</p>
<p>You might find that the original weight was recorded in medical records as 70.2kg. You can change this in R by writing code.</p>
<p><strong>Note:</strong> many statistical packages will allow you to view a spreadsheet version of your data and edit values in that spreadsheet. This is not best practice, as corrected observations may revert to their original values depending on whether the edited data have been saved or not. By using code-based recoding, the changes will be reproduced the next time the code is run.</p>
<p>We will use an <code>ifelse</code> statement to recode the incorrect weight of 700.2kg into 70.2kg. The form of the <code>ifelse</code> statement is as follows:</p>
<p><code>ifelse(test, value_if_true, value_if_false)</code></p>
<p>Our code will create a new column (called <code>weight_clean</code>) in the <code>sample</code> dataframe. We will test whether <code>weight</code> is equal to 700.2; if this is true, we will assign <code>weight_clean</code> to be 70.2, otherwise <code>weight_clean</code> will equal the value of <code>weight</code>.</p>
<p>Putting it all together:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="probability-and-probability-distributions-r-notes.html#cb42-1" aria-hidden="true" tabindex="-1"></a>sample<span class="sc">$</span>weight_clean <span class="ot">=</span> <span class="fu">ifelse</span>(sample<span class="sc">$</span>weight<span class="sc">==</span><span class="fl">700.2</span>, <span class="fl">70.2</span>, sample<span class="sc">$</span>weight)</span></code></pre></div>
<p><strong>Note:</strong> if an extreme value lies within the range of biological plausibility it should not be removed from analysis.</p>
<p>Once you have checked your data for errors, you are ready to start analysing your data.</p>
<div id="what-on-earth" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> What on earth: == ?<a href="probability-and-probability-distributions-r-notes.html#what-on-earth" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In R, the test of equality is denoted by two equal signs: <code>==</code>. So we would use <code>==</code> to test whether an observation is equal to a certain value. Let’s see an example:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="probability-and-probability-distributions-r-notes.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test whether 6 is equal to 6</span></span>
<span id="cb43-2"><a href="probability-and-probability-distributions-r-notes.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="sc">==</span> <span class="dv">6</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="probability-and-probability-distributions-r-notes.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test whether 6 is equal to 42</span></span>
<span id="cb45-2"><a href="probability-and-probability-distributions-r-notes.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="sc">==</span> <span class="dv">42</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>You can read the <code>==</code> as “is equal to”. So the code <code>sample$weight == 700.2</code> is read as: “is the value of weight from the data frame sample equal to 700.2?”. In our <code>ifelse</code> statement above, if this condition is true, we replace <code>weight</code> by 70.2; if it is false, we leave weight as is.</p>
</div>
</div>
<div id="overlaying-a-normal-curve-on-a-histogram" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Overlaying a Normal curve on a histogram<a href="probability-and-probability-distributions-r-notes.html#overlaying-a-normal-curve-on-a-histogram" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It can be useful to produce a histogram with an overlayed Normal curve to assess whether our sample appears approximately Normally distributed.</p>
<div id="base-graphics" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Base graphics<a href="probability-and-probability-distributions-r-notes.html#base-graphics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="probability-and-probability-distributions-r-notes.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample<span class="sc">$</span>weight_clean, <span class="at">xlab=</span><span class="st">&quot;Weight (kg)&quot;</span>, <span class="at">main=</span><span class="st">&quot;Histogram of 1000 weights&quot;</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-2"><a href="probability-and-probability-distributions-r-notes.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean=</span><span class="fu">mean</span>(sample<span class="sc">$</span>weight_clean), <span class="at">sd=</span><span class="fu">sd</span>(sample<span class="sc">$</span>weight_clean)), <span class="at">col=</span><span class="st">&quot;darkblue&quot;</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="phcm9795-R-notes_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="probability-and-probability-distributions-r-notes.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample<span class="sc">$</span>weight_clean, <span class="at">xlab=</span><span class="st">&quot;Weight (kg)&quot;</span>, <span class="at">main=</span><span class="st">&quot;Histogram of 1000 weights&quot;</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>))</span>
<span id="cb48-2"><a href="probability-and-probability-distributions-r-notes.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean=</span><span class="fu">mean</span>(sample<span class="sc">$</span>weight_clean), <span class="at">sd=</span><span class="fu">sd</span>(sample<span class="sc">$</span>weight_clean)), <span class="at">col=</span><span class="st">&quot;darkblue&quot;</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="phcm9795-R-notes_files/figure-html/unnamed-chunk-50-2.png" width="672" /></p>
</div>
</div>
<div id="ggplot2" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> ggplot2<a href="probability-and-probability-distributions-r-notes.html#ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="probability-and-probability-distributions-r-notes.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sample, <span class="fu">aes</span>(<span class="at">x=</span>weight_clean)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">50</span>, <span class="dv">90</span>, <span class="dv">5</span>), <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">fill=</span><span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-2"><a href="probability-and-probability-distributions-r-notes.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm,</span>
<span id="cb49-3"><a href="probability-and-probability-distributions-r-notes.html#cb49-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(sample<span class="sc">$</span>weight_clean),</span>
<span id="cb49-4"><a href="probability-and-probability-distributions-r-notes.html#cb49-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sd =</span> <span class="fu">sd</span>(sample<span class="sc">$</span>weight_clean)),</span>
<span id="cb49-5"><a href="probability-and-probability-distributions-r-notes.html#cb49-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour=</span><span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-6"><a href="probability-and-probability-distributions-r-notes.html#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb49-7"><a href="probability-and-probability-distributions-r-notes.html#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Histogram of 1000 weights&quot;</span>, <span class="at">x=</span><span class="st">&quot;Weight (kg)&quot;</span>, <span class="at">y=</span><span class="st">&quot;Density&quot;</span>)</span></code></pre></div>
<p><img src="phcm9795-R-notes_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
</div>
<div id="descriptive-statistics-for-checking-normality" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Descriptive statistics for checking normality<a href="probability-and-probability-distributions-r-notes.html#descriptive-statistics-for-checking-normality" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>All the descriptive statistics including Skewness and Kurtosis discussed in this module can be obtained using the <code>descriptives</code> function from the <code>jmv</code> package. In particular, skewness and kurtosis can be requested over and above the default statistics (<code>skew=TRUE, kurt=TRUE</code>):</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="probability-and-probability-distributions-r-notes.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">descriptives</span>(<span class="at">data=</span>sample, <span class="at">vars=</span>weight_clean, <span class="at">skew=</span><span class="cn">TRUE</span>, <span class="at">kurt=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  DESCRIPTIVES
## 
##  Descriptives                            
##  ─────────────────────────────────────── 
##                           weight_clean   
##  ─────────────────────────────────────── 
##    N                              1000   
##    Missing                           0   
##    Mean                       69.76450   
##    Median                     69.80000   
##    Standard deviation         5.052676   
##    Minimum                    53.80000   
##    Maximum                    85.80000   
##    Skewness                 0.07360659   
##    Std. error skewness      0.07734382   
##    Kurtosis                 0.05418774   
##    Std. error kurtosis       0.1545343   
##  ───────────────────────────────────────</code></pre>
</div>
<div id="import-excel" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Importing Excel data into Stata<a href="probability-and-probability-distributions-r-notes.html#import-excel" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Another common type of file that data are stored in is a Microsoft Excel file (.xls or .xlsx). In this demonstration, we will import a selection of records from a large health survey, stored in the file <code>health-survey.xlsx</code>.</p>
<p>The health survey data contains 1140 records, comprising:</p>
<ul>
<li>sex: 1 = respondent identifies as male; 2 = respondent identifies as female</li>
<li>height: height in meters</li>
<li>weight: weight in kilograms</li>
</ul>
<p>To import data from Microsoft Excel, we can use the <code>read_excel()</code> function in the <code>readxl</code> package.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="probability-and-probability-distributions-r-notes.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb52-2"><a href="probability-and-probability-distributions-r-notes.html#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="probability-and-probability-distributions-r-notes.html#cb52-3" aria-hidden="true" tabindex="-1"></a>survey <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;data/examples/health-survey.xlsx&quot;</span>)</span>
<span id="cb52-4"><a href="probability-and-probability-distributions-r-notes.html#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(survey)</span></code></pre></div>
<pre><code>##       sex           height          weight      
##  Min.   :1.00   Min.   :1.220   Min.   : 22.70  
##  1st Qu.:1.00   1st Qu.:1.630   1st Qu.: 68.00  
##  Median :2.00   Median :1.700   Median : 79.40  
##  Mean   :1.55   Mean   :1.698   Mean   : 81.19  
##  3rd Qu.:2.00   3rd Qu.:1.780   3rd Qu.: 90.70  
##  Max.   :2.00   Max.   :2.010   Max.   :213.20</code></pre>
<p>We can see that sex has been entered as a numeric variable. We should transform it into a factor so that we can assign labels to each category:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="probability-and-probability-distributions-r-notes.html#cb54-1" aria-hidden="true" tabindex="-1"></a>survey<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(survey<span class="sc">$</span>sex, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>))</span>
<span id="cb54-2"><a href="probability-and-probability-distributions-r-notes.html#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="probability-and-probability-distributions-r-notes.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(survey<span class="sc">$</span>sex)</span></code></pre></div>
<pre><code>##   Male Female 
##    513    627</code></pre>
<p>We also note that height looks like it has been entered as meters, and weight as kilograms.</p>
</div>
<div id="generating-new-variables" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> Generating new variables<a href="probability-and-probability-distributions-r-notes.html#generating-new-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our health survey data contains information on height and weight. We often summarise body size using BMI: body mass index which is calculated as: <span class="math inline">\(\frac{\text{weight (kg)}}{(\text{height (m)})^2}\)</span></p>
<p>We can create a new column in our dataframe in many ways, and we will present two alternatives.</p>
<div id="base-r" class="section level3 hasAnchor" number="2.7.1">
<h3><span class="header-section-number">2.7.1</span> Base R<a href="probability-and-probability-distributions-r-notes.html#base-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A new column can be generated using the following approach:</p>
<p><code>dataframe$new_column = &lt;formula&gt;</code></p>
<p>For example:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="probability-and-probability-distributions-r-notes.html#cb56-1" aria-hidden="true" tabindex="-1"></a>survey<span class="sc">$</span>bmi <span class="ot">=</span> survey<span class="sc">$</span>weight <span class="sc">/</span> (survey<span class="sc">$</span>height<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="tidyverse" class="section level3 hasAnchor" number="2.7.2">
<h3><span class="header-section-number">2.7.2</span> tidyverse<a href="probability-and-probability-distributions-r-notes.html#tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using the tidyverse approach, we use the <code>mutate</code> command to change (or create) a column of data within the dataframe:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="probability-and-probability-distributions-r-notes.html#cb57-1" aria-hidden="true" tabindex="-1"></a>survey <span class="ot">&lt;-</span> survey <span class="sc">%&gt;%</span> </span>
<span id="cb57-2"><a href="probability-and-probability-distributions-r-notes.html#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bmi =</span> weight <span class="sc">/</span> (height<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<p>We should check the construction of the new variable by examining some records, and examining a histogram and boxplot:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="probability-and-probability-distributions-r-notes.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(survey)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-57">
<caption style="caption-side: top; text-align: center;"><span id="tab:unnamed-chunk-57">Table 2.2: </span> </caption><col><col><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">sex</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">height</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">weight</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">bmi</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Male</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.63</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">81.7</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">30.8</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Male</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.63</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">68&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">25.6</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Male</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.85</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">97.1</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">28.4</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Male</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.78</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">89.8</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">28.3</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Male</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.73</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">70.3</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">23.5</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Female</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.57</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">85.7</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">34.8</td></tr>
</table>

<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="probability-and-probability-distributions-r-notes.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(survey)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-57">
<caption style="caption-side: top; text-align: center;"><span id="tab:unnamed-chunk-57">Table 2.2: </span> </caption><col><col><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">sex</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">height</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">weight</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">bmi</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Female</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.65</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">95.7</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">35.2</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Male</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.8&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">79.4</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">24.5</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Female</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.73</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">83&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">27.7</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Female</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.57</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">61.2</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">24.8</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">Male</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">1.7&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">73&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; background-color: rgb(242, 242, 242); font-weight: normal;">25.3</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0.4pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Female</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.55</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">91.2</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0.4pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">38&nbsp;&nbsp;</td></tr>
</table>

<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="probability-and-probability-distributions-r-notes.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(survey<span class="sc">$</span>bmi)</span></code></pre></div>
<p><img src="phcm9795-R-notes_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="probability-and-probability-distributions-r-notes.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(survey<span class="sc">$</span>bmi)</span></code></pre></div>
<p><img src="phcm9795-R-notes_files/figure-html/unnamed-chunk-57-2.png" width="672" /></p>
<p>In the general population, BMI ranges between about 15 to 30. It appears that BMI has been correctly generated in this example. We should investigate the very low and some of the very high values of BMI, but this will be left for another time.</p>
</div>
</div>
<div id="summarising-data-by-another-variable" class="section level2 hasAnchor" number="2.8">
<h2><span class="header-section-number">2.8</span> Summarising data by another variable<a href="probability-and-probability-distributions-r-notes.html#summarising-data-by-another-variable" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will often want to calculate the same summary statistics by another variable. For example, we might want to calculate summary statistics for BMI for males and females separately. We can do this in in the <code>descriptives</code> function by defining sex as a <code>splitBy</code> variable:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="probability-and-probability-distributions-r-notes.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">descriptives</span>(<span class="at">data=</span>survey, <span class="at">vars=</span>bmi, <span class="at">splitBy =</span> sex)</span></code></pre></div>
<pre><code>## 
##  DESCRIPTIVES
## 
##  Descriptives                                 
##  ──────────────────────────────────────────── 
##                          sex       bmi        
##  ──────────────────────────────────────────── 
##    N                     Male           513   
##                          Female         627   
##    Missing               Male             0   
##                          Female           0   
##    Mean                  Male      28.29561   
##                          Female    27.81434   
##    Median                Male      27.39592   
##                          Female    26.66667   
##    Standard deviation    Male      5.204975   
##                          Female    6.380523   
##    Minimum               Male      16.47519   
##                          Female    9.209299   
##    Maximum               Male      57.23644   
##                          Female    52.59516   
##  ────────────────────────────────────────────</code></pre>
<p>[PLOTS BY VARIABLES]</p>
</div>
<div id="recoding-data" class="section level2 hasAnchor" number="2.9">
<h2><span class="header-section-number">2.9</span> Recoding data<a href="probability-and-probability-distributions-r-notes.html#recoding-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One task that is common in statistical computing is to recode variables. For example, we might want to group some categories of a categorical variable, or to present a continuous variable in a categorical way.</p>
<p>In this example, we can recode BMI into the following categories as suggested by the World Health Organisation [footnote]:</p>
<ul>
<li>Underweight: BMI &lt; 18.5</li>
<li>Normal weight: 18.5 <span class="math inline">\(\le\)</span> BMI &lt; 25</li>
<li>Pre-obesity: 25 <span class="math inline">\(\le\)</span> BMI &lt; 30</li>
<li>Obesity Class I: 30 <span class="math inline">\(\le\)</span> BMI &lt; 35</li>
<li>Obesity Class II: 35 <span class="math inline">\(\le\)</span> BMI &lt; 40</li>
<li>Obesity Class III: BMI <span class="math inline">\(\ge\)</span> 40</li>
</ul>
<p>The quickest way to recode a continuous variable into categories is to use the <code>cut</code> command which takes a continuous variable, and “cuts” it into groups based on the specified “cutpoints”:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="probability-and-probability-distributions-r-notes.html#cb64-1" aria-hidden="true" tabindex="-1"></a>survey<span class="sc">$</span>bmi_cat <span class="ot">&lt;-</span> <span class="fu">cut</span>(survey<span class="sc">$</span>bmi, <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">18.5</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">100</span>))</span></code></pre></div>
<p>Notice that lower (BMI=0) and upper (BMI=100) bounds have been specified, as both a lower and upper limit must be defined for each group.</p>
<p>If we examine the new <code>bmi_cat</code> variable:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="probability-and-probability-distributions-r-notes.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(survey<span class="sc">$</span>bmi_cat)</span></code></pre></div>
<pre><code>##  (0,18.5] (18.5,25]   (25,30]   (30,35]   (35,40]  (40,100] 
##        18       362       411       205        97        47</code></pre>
<p>we see that each group has been labelled (a, b]. This notation is equivalent to: greater than a, and less than or equal to b. The <code>cut</code> function excludes the lower limit, but includes the upper limit. Our BMI ranges have been defined to include the lower limit, and exclude the upper limit (for example, greater than or equal to 30 and less than 35).</p>
<p>We can specify this recoding using the <code>right=FALSE</code> option:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="probability-and-probability-distributions-r-notes.html#cb67-1" aria-hidden="true" tabindex="-1"></a>survey<span class="sc">$</span>bmi_cat <span class="ot">&lt;-</span> <span class="fu">cut</span>(survey<span class="sc">$</span>bmi, <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">18.5</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">100</span>), <span class="at">right=</span><span class="cn">FALSE</span>)</span>
<span id="cb67-2"><a href="probability-and-probability-distributions-r-notes.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(survey<span class="sc">$</span>bmi_cat)</span></code></pre></div>
<pre><code>##  [0,18.5) [18.5,25)   [25,30)   [30,35)   [35,40)  [40,100) 
##        18       362       411       201       101        47</code></pre>
<p>More complex recoding can be done using the <code>case_when</code> command in the <code>dplyr</code> package.</p>
<p>[INCLUDE???]</p>
</div>
<div id="computing-binomial-probabilities-using-r" class="section level2 hasAnchor" number="2.10">
<h2><span class="header-section-number">2.10</span> Computing binomial probabilities using R<a href="probability-and-probability-distributions-r-notes.html#computing-binomial-probabilities-using-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are two R functions that we can use to calculate probabilities based on the binomial distribution: <code>dbinom</code> and <code>pbinom</code>:</p>
<ul>
<li><code>dbinom(x, size, prob)</code> gives the probability of obtaining <code>x</code> successes from <code>size</code> trials when the probability of a success on one trial is <code>prob</code>;</li>
<li><code>pbinom(q, size, prob)</code> gives the probability of obtaining <code>q</code> <strong>or fewer</strong> successes from <code>size</code> trials when the probability of a success on one trial is <code>prob</code>;</li>
<li><code>pbinom(q, size, prob, lower.tail=FALSE)</code> gives the probability of obtaining <strong>more than</strong> <code>q</code>successes from <code>size</code> trials when the probability of a success on one trial is <code>prob</code>.</li>
</ul>
<p>To do the computation for part (a) in Worked Example 2.1, we will use the <code>dbinom</code> function with:</p>
<ul>
<li><em>x</em> is the number of successes, here, the number of smokers (i.e. k=3);</li>
<li><em>size</em> is the number of trials (i.e. n=6);</li>
<li>and <em>prob</em> is probability of drawing a smoker from the population, which is 19.8% (i.e. p=0.198).</li>
</ul>
<p>Replace each of these with the appropriate number into the formula:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="probability-and-probability-distributions-r-notes.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">prob=</span><span class="fl">0.198</span>)</span></code></pre></div>
<pre><code>## [1] 0.08008454</code></pre>
<p>To calculate the upper tail of probability in part (b), we use the <code>pbinom(lower.tail=FALSE)</code> function. Note that the <code>pbinom(lower.tail=FALSE)</code> function <strong>does not include <code>q</code></strong>, so to obtain 4 or more successes, we need to enter <code>q=3</code>:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="probability-and-probability-distributions-r-notes.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q=</span><span class="dv">3</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">prob=</span><span class="fl">0.198</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.01635325</code></pre>
<p>For the lower tail for part (c), we use the <code>pbinom</code> function:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="probability-and-probability-distributions-r-notes.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q=</span><span class="dv">2</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">prob=</span><span class="fl">0.198</span>)</span></code></pre></div>
<pre><code>## [1] 0.9035622</code></pre>
</div>
<div id="computing-probabilities-from-a-normal-distribution" class="section level2 hasAnchor" number="2.11">
<h2><span class="header-section-number">2.11</span> Computing probabilities from a Normal distribution<a href="probability-and-probability-distributions-r-notes.html#computing-probabilities-from-a-normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can use the <code>pnorm</code> function to calculate probabilities from a Normal distribution:</p>
<ul>
<li><code>pnorm(q, mean, sd)</code> calculates the probability of observing a value of <code>q</code> or less, from a Normal distribution with a mean of <code>mean</code> and a standard deviation of <code>sd</code>. Note that if <code>mean</code> and <code>sd</code> are not entered, they are assumed to be 0 and 1 respectively (i.e. a standard normal distribution.)</li>
<li><code>pnorm(q, mean, sd, lower.tail=FALSE)</code> calculates the probability of observing a value of <code>q</code> or more, from a Normal distribution with a mean of <code>mean</code> and a standard deviation of <code>sd</code>.</li>
</ul>
<p>To obtain the probability of obtaining 0.5 or greater from a standard normal distribution:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="probability-and-probability-distributions-r-notes.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">0.5</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.3085375</code></pre>
<p>To calculate the worked example: Assume that the mean diastolic blood pressure for men is 77.9 mmHg, with a standard deviation of 11. What is the probability that a man selected at random will have high blood pressure (i.e. diastolic blood pressure <span class="math inline">\(ge\)</span> 90)?</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="probability-and-probability-distributions-r-notes.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">90</span>, <span class="at">mean=</span><span class="fl">77.9</span>, <span class="at">sd=</span><span class="dv">11</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.1356661</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-r-and-rstudio.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="precision-r-notes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["phcm9795-R-notes.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
