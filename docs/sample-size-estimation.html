<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 10 Sample size estimation | PHCM9795 Foundations of Biostatistics</title>
  <meta name="description" content="Module 10 Sample size estimation | PHCM9795 Foundations of Biostatistics" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 10 Sample size estimation | PHCM9795 Foundations of Biostatistics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 10 Sample size estimation | PHCM9795 Foundations of Biostatistics" />
  
  
  

<meta name="author" content="Pilot Notes for R" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="analysing-non-normal-data.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">PHCM9795 Foundations of Biostatistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Introduction to R and RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#learning-outcomes"><i class="fa fa-check"></i>Learning outcomes</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#part-1-an-introduction-to-r"><i class="fa fa-check"></i>Part 1: An introduction to R</a></li>
<li class="chapter" data-level="1.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#r-vs-rstudio"><i class="fa fa-check"></i><b>1.1</b> R vs RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>1.2</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#recommended-setup"><i class="fa fa-check"></i><b>1.3</b> Recommended setup</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#simpleR"><i class="fa fa-check"></i><b>1.4</b> A simple R analysis</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#the-rstudio-environment"><i class="fa fa-check"></i><b>1.5</b> The RStudio environment</a></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#some-r-basics"><i class="fa fa-check"></i><b>1.6</b> Some R basics</a></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#what-is-this-thing-called-the-tidyverse"><i class="fa fa-check"></i><b>1.7</b> What is this thing called the tidyverse?</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#part-2-obtaining-basic-descriptive-statistics"><i class="fa fa-check"></i>Part 2: Obtaining basic descriptive statistics</a></li>
<li class="chapter" data-level="1.8" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#set-up-your-data"><i class="fa fa-check"></i><b>1.8</b> Set up your data</a></li>
<li class="chapter" data-level="1.9" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#reading-a-data-file"><i class="fa fa-check"></i><b>1.9</b> Reading a data file</a></li>
<li class="chapter" data-level="1.10" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#summarising-continuous-variables"><i class="fa fa-check"></i><b>1.10</b> Summarising continuous variables</a></li>
<li class="chapter" data-level="1.11" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#producing-a-histogram"><i class="fa fa-check"></i><b>1.11</b> Producing a histogram</a></li>
<li class="chapter" data-level="1.12" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#producing-a-boxplot"><i class="fa fa-check"></i><b>1.12</b> Producing a boxplot</a></li>
<li class="chapter" data-level="1.13" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#producing-a-one-way-frequency-table"><i class="fa fa-check"></i><b>1.13</b> Producing a one-way frequency table</a></li>
<li class="chapter" data-level="1.14" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#producing-a-two-way-frequency-table"><i class="fa fa-check"></i><b>1.14</b> Producing a two-way frequency table</a></li>
<li class="chapter" data-level="1.15" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#saving-data-in-r"><i class="fa fa-check"></i><b>1.15</b> Saving data in R</a></li>
<li class="chapter" data-level="1.16" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#copying-output-from-r"><i class="fa fa-check"></i><b>1.16</b> Copying output from R</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#part-3-creating-other-types-of-graphs"><i class="fa fa-check"></i>Part 3: Creating other types of graphs</a></li>
<li class="chapter" data-level="1.17" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#bar-graphs"><i class="fa fa-check"></i><b>1.17</b> Bar graphs</a></li>
<li class="chapter" data-level="1.18" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#creating-line-graphs"><i class="fa fa-check"></i><b>1.18</b> Creating line graphs</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html"><i class="fa fa-check"></i><b>2</b> Probability and probability distributions</a>
<ul>
<li class="chapter" data-level="2.1" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#importing-data-into-r"><i class="fa fa-check"></i><b>2.1</b> Importing data into R</a></li>
<li class="chapter" data-level="2.2" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#checking-your-data-for-errors-in-r"><i class="fa fa-check"></i><b>2.2</b> Checking your data for errors in R</a></li>
<li class="chapter" data-level="2.3" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#overlaying-a-normal-curve-on-a-histogram"><i class="fa fa-check"></i><b>2.3</b> Overlaying a Normal curve on a histogram</a></li>
<li class="chapter" data-level="2.4" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#descriptive-statistics-for-checking-normality"><i class="fa fa-check"></i><b>2.4</b> Descriptive statistics for checking normality</a></li>
<li class="chapter" data-level="2.5" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#import-excel"><i class="fa fa-check"></i><b>2.5</b> Importing Excel data into R</a></li>
<li class="chapter" data-level="2.6" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#generating-new-variables"><i class="fa fa-check"></i><b>2.6</b> Generating new variables</a></li>
<li class="chapter" data-level="2.7" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#summarising-data-by-another-variable"><i class="fa fa-check"></i><b>2.7</b> Summarising data by another variable</a></li>
<li class="chapter" data-level="2.8" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#summarising-a-single-column-of-data"><i class="fa fa-check"></i><b>2.8</b> Summarising a single column of data</a></li>
<li class="chapter" data-level="2.9" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#plotting-data-by-another-variable"><i class="fa fa-check"></i><b>2.9</b> Plotting data by another variable</a></li>
<li class="chapter" data-level="2.10" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#recoding-data"><i class="fa fa-check"></i><b>2.10</b> Recoding data</a></li>
<li class="chapter" data-level="2.11" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#computing-binomial-probabilities-using-r"><i class="fa fa-check"></i><b>2.11</b> Computing binomial probabilities using R</a></li>
<li class="chapter" data-level="2.12" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#computing-probabilities-from-a-normal-distribution"><i class="fa fa-check"></i><b>2.12</b> Computing probabilities from a Normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="precision-r-notes.html"><a href="precision-r-notes.html"><i class="fa fa-check"></i><b>3</b> Precision: R notes</a>
<ul>
<li class="chapter" data-level="3.1" data-path="precision-r-notes.html"><a href="precision-r-notes.html#calculating-a-95-confidence-interval-of-a-mean"><i class="fa fa-check"></i><b>3.1</b> Calculating a 95% confidence interval of a mean</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>4</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="4.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-sample-t-test"><i class="fa fa-check"></i><b>4.1</b> One sample t-test</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="comparing-two-means.html"><a href="comparing-two-means.html"><i class="fa fa-check"></i><b>5</b> Comparing two means</a>
<ul>
<li class="chapter" data-level="5.1" data-path="comparing-two-means.html"><a href="comparing-two-means.html#setting-an-observation-to-missing"><i class="fa fa-check"></i><b>5.1</b> Setting an observation to missing</a></li>
<li class="chapter" data-level="5.2" data-path="comparing-two-means.html"><a href="comparing-two-means.html#checking-data-for-the-independent-samples-t-test"><i class="fa fa-check"></i><b>5.2</b> Checking data for the independent samples t-test</a></li>
<li class="chapter" data-level="5.3" data-path="comparing-two-means.html"><a href="comparing-two-means.html#independent-samples-t-test"><i class="fa fa-check"></i><b>5.3</b> Independent samples t-test</a></li>
<li class="chapter" data-level="5.4" data-path="comparing-two-means.html"><a href="comparing-two-means.html#checking-the-assumptions-for-a-paired-t-test"><i class="fa fa-check"></i><b>5.4</b> Checking the assumptions for a Paired t-test</a></li>
<li class="chapter" data-level="5.5" data-path="comparing-two-means.html"><a href="comparing-two-means.html#paired-t-test"><i class="fa fa-check"></i><b>5.5</b> Paired t-Test</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="summary-statistics-for-binary-data.html"><a href="summary-statistics-for-binary-data.html"><i class="fa fa-check"></i><b>6</b> Summary statistics for binary data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="summary-statistics-for-binary-data.html"><a href="summary-statistics-for-binary-data.html#confidence-intervals-for-proportions"><i class="fa fa-check"></i><b>6.1</b> 95% confidence intervals for proportions</a></li>
<li class="chapter" data-level="6.2" data-path="summary-statistics-for-binary-data.html"><a href="summary-statistics-for-binary-data.html#significance-test-for-single-proportion"><i class="fa fa-check"></i><b>6.2</b> Significance test for single proportion</a></li>
<li class="chapter" data-level="6.3" data-path="summary-statistics-for-binary-data.html"><a href="summary-statistics-for-binary-data.html#computing-a-relative-risk-and-its-95-confidence-interval"><i class="fa fa-check"></i><b>6.3</b> Computing a relative risk and its 95% confidence interval</a></li>
<li class="chapter" data-level="6.4" data-path="summary-statistics-for-binary-data.html"><a href="summary-statistics-for-binary-data.html#computing-a-difference-in-proportions-and-its-95-confidence-interval"><i class="fa fa-check"></i><b>6.4</b> Computing a difference in proportions and its 95% confidence interval</a></li>
<li class="chapter" data-level="6.5" data-path="summary-statistics-for-binary-data.html"><a href="summary-statistics-for-binary-data.html#computing-an-odds-ratio-and-its-95-confidence-interval"><i class="fa fa-check"></i><b>6.5</b> Computing an odds ratio and its 95% confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="hypothesis-testing-for-categorical-data.html"><a href="hypothesis-testing-for-categorical-data.html"><i class="fa fa-check"></i><b>7</b> Hypothesis testing for categorical data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="hypothesis-testing-for-categorical-data.html"><a href="hypothesis-testing-for-categorical-data.html#pearsons-chi-squared-test"><i class="fa fa-check"></i><b>7.1</b> Pearson’s chi-squared test</a></li>
<li class="chapter" data-level="7.2" data-path="hypothesis-testing-for-categorical-data.html"><a href="hypothesis-testing-for-categorical-data.html#chi-squared-test-for-tables-larger-than-2-by-2"><i class="fa fa-check"></i><b>7.2</b> Chi-squared test for tables larger than 2-by-2</a></li>
<li class="chapter" data-level="7.3" data-path="hypothesis-testing-for-categorical-data.html"><a href="hypothesis-testing-for-categorical-data.html#mcnemars-test-for-paired-proportions"><i class="fa fa-check"></i><b>7.3</b> McNemar’s test for paired proportions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="correlation-and-simple-linear-regression.html"><a href="correlation-and-simple-linear-regression.html"><i class="fa fa-check"></i><b>8</b> Correlation and simple linear regression</a>
<ul>
<li class="chapter" data-level="8.1" data-path="correlation-and-simple-linear-regression.html"><a href="correlation-and-simple-linear-regression.html#creating-a-scatter-plot"><i class="fa fa-check"></i><b>8.1</b> Creating a scatter plot</a></li>
<li class="chapter" data-level="8.2" data-path="correlation-and-simple-linear-regression.html"><a href="correlation-and-simple-linear-regression.html#fitting-a-simple-linear-regression-model"><i class="fa fa-check"></i><b>8.2</b> Fitting a simple linear regression model</a></li>
<li class="chapter" data-level="8.3" data-path="correlation-and-simple-linear-regression.html"><a href="correlation-and-simple-linear-regression.html#plotting-residuals-from-a-simple-linear-regression"><i class="fa fa-check"></i><b>8.3</b> Plotting residuals from a simple linear regression</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html"><i class="fa fa-check"></i><b>9</b> Analysing non-normal data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#transforming-non-normally-distributed-variables"><i class="fa fa-check"></i><b>9.1</b> Transforming non-normally distributed variables</a></li>
<li class="chapter" data-level="9.2" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#wilcoxon-ranked-sum-test"><i class="fa fa-check"></i><b>9.2</b> Wilcoxon ranked-sum test</a></li>
<li class="chapter" data-level="9.3" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#wilcoxon-matched-pairs-signed-rank-test"><i class="fa fa-check"></i><b>9.3</b> Wilcoxon matched-pairs signed-rank test</a></li>
<li class="chapter" data-level="9.4" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#estimating-rank-correlation-coefficients"><i class="fa fa-check"></i><b>9.4</b> Estimating rank correlation coefficients</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html"><i class="fa fa-check"></i><b>10</b> Sample size estimation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html#sample-size-calculation-for-the-independent-samples-t-test"><i class="fa fa-check"></i><b>10.1</b> Sample size calculation for the independent samples t-test</a></li>
<li class="chapter" data-level="10.2" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html#sample-size-calculation-for-the-paired-t-test"><i class="fa fa-check"></i><b>10.2</b> Sample size calculation for the paired t-test</a></li>
<li class="chapter" data-level="10.3" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html#sample-size-calculation-for-difference-between-two-independent-proportions"><i class="fa fa-check"></i><b>10.3</b> Sample size calculation for difference between two independent proportions</a></li>
<li class="chapter" data-level="10.4" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html#sample-size-calculation-with-a-relative-risk"><i class="fa fa-check"></i><b>10.4</b> Sample size calculation with a relative risk</a></li>
<li class="chapter" data-level="10.5" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html#sample-size-calculation-with-an-odds-ratio"><i class="fa fa-check"></i><b>10.5</b> Sample size calculation with an odds ratio</a></li>
<li class="chapter" data-level="10.6" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html#estimating-sample-sizes-with-unequal-groups"><i class="fa fa-check"></i><b>10.6</b> Estimating sample sizes with unequal groups</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PHCM9795 Foundations of Biostatistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sample-size-estimation" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Module 10</span> Sample size estimation<a href="sample-size-estimation.html#sample-size-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Many power and sample size procedures are available in the <code>epiR</code> package. We will also use one function from the <code>pwr</code> package.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="sample-size-estimation.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If not yet installed, submit the following:</span></span>
<span id="cb228-2"><a href="sample-size-estimation.html#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;epiR&quot;)</span></span>
<span id="cb228-3"><a href="sample-size-estimation.html#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;pwr&quot;)</span></span>
<span id="cb228-4"><a href="sample-size-estimation.html#cb228-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(epiR)</span>
<span id="cb228-5"><a href="sample-size-estimation.html#cb228-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span></code></pre></div>
<p>We will use three functions from the <code>epiR</code> package in this module:</p>
<ul>
<li><code>epi.sscompc</code> to estimate the sample size to compare continuous outcomes</li>
<li><code>epi.sscohortc</code> to estimate the sample size to compare two independent proportions from a cohort or cross-sectional study</li>
<li><code>epi.sscc</code> to estimate the sample size to compare two independent proportions from a case-control study</li>
</ul>
<p>We will use one function from the <code>pwr</code> package:</p>
<ul>
<li><code>pwr.t.test</code> estimate the sample size to compare means from a paired study</li>
</ul>
<div id="sample-size-calculation-for-the-independent-samples-t-test" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Sample size calculation for the independent samples t-test<a href="sample-size-estimation.html#sample-size-calculation-for-the-independent-samples-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To do the problem discussed in Worked Example 10.2, we use the <code>epi.sscompc</code> function:</p>
<pre><code>epi.sscompc(treat, control, n, sigma, power, 
   r = 1, design = 1, sided.test = 2, nfractional = FALSE, conf.level = 0.95)</code></pre>
<p>The first line contains parameters that we usually specify, with the second line usually left as the defaults. We must define the expected mean in the treatment and control groups, and the standard deviation of the measure. We specify one of <code>n</code> or <code>power</code> to be the measure to estimate, by specifying the unknown value as being equal to R’s missing value, <code>NA</code>.</p>
<p>For example, to calculate the required sample size in Worked Example 10.2, we specify:</p>
<ul>
<li>the assumed mean in the experimental, or treatment, group: 90mmHg</li>
<li>the assumed mean in the control group: 95mmHg</li>
<li>the standard deviation of blood pressure: 25mmHg</li>
<li>the required power, 0.9 (representing 90%)</li>
</ul>
<p>The values on the second line of the function are defined by default, and we can leave these as default.</p>
<p>Putting this all together, and specifying the sample size as unknown:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="sample-size-estimation.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.sscompc</span>(<span class="at">treat=</span><span class="dv">90</span>, <span class="at">control=</span><span class="dv">95</span>, <span class="at">n=</span><span class="cn">NA</span>, <span class="at">sigma=</span><span class="dv">25</span>, <span class="at">power=</span><span class="fl">0.9</span>) </span></code></pre></div>
<pre><code>## $n.total
## [1] 1052
## 
## $n.treat
## [1] 526
## 
## $n.control
## [1] 526
## 
## $power
## [1] 0.9
## 
## $delta
## [1] 5</code></pre>
<p>The results indicate that we need 526 participants in each group, or 1052 in total. Note that these numbers are slightly different from the Stata estimates (527 in each group).</p>
<p>We can define whether we want unequal numbers in each group by specifying <code>r</code>: the number in the treatment group divided by the number in the control group.</p>
</div>
<div id="sample-size-calculation-for-the-paired-t-test" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Sample size calculation for the paired t-test<a href="sample-size-estimation.html#sample-size-calculation-for-the-paired-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Calculating the sample size required for a paired t-test is a little more cumbersome. We can use the following code to specify:</p>
<ul>
<li><code>m1</code>: the mean of the first paired observations</li>
<li><code>m2</code>: the mean of the second paired observations</li>
<li><code>s_group</code>: the common standard deviation</li>
<li><code>corr</code>: the assumed correlation between the paired observations (conservatively set to 0)</li>
</ul>
<p>The code below then uses the <code>pwr.t.test</code> function within the <code>pwr</code> library to estimate the number of pairs. For example, to replicate Output 10.2:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="sample-size-estimation.html#cb232-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="dv">90</span></span>
<span id="cb232-2"><a href="sample-size-estimation.html#cb232-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="dv">95</span></span>
<span id="cb232-3"><a href="sample-size-estimation.html#cb232-3" aria-hidden="true" tabindex="-1"></a>s_group <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb232-4"><a href="sample-size-estimation.html#cb232-4" aria-hidden="true" tabindex="-1"></a>corr <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb232-5"><a href="sample-size-estimation.html#cb232-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-6"><a href="sample-size-estimation.html#cb232-6" aria-hidden="true" tabindex="-1"></a>s_paired <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> s_group<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>corr<span class="sc">*</span>s_group<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb232-7"><a href="sample-size-estimation.html#cb232-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-8"><a href="sample-size-estimation.html#cb232-8" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> ((m1 <span class="sc">-</span> m2)<span class="sc">/</span>s_paired)</span>
<span id="cb232-9"><a href="sample-size-estimation.html#cb232-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-10"><a href="sample-size-estimation.html#cb232-10" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t.test</span>(<span class="at">d=</span>d, <span class="at">power=</span><span class="fl">0.9</span>, <span class="at">type=</span><span class="st">&quot;paired&quot;</span>)</span></code></pre></div>
<pre><code>## 
##      Paired t test power calculation 
## 
##               n = 527.2954
##               d = 0.1414214
##       sig.level = 0.05
##           power = 0.9
##     alternative = two.sided
## 
## NOTE: n is number of *pairs*</code></pre>
<p>As per the Stata calculations, we require 528 pairs of observations (noting that <strong>sample sizes are always rounded up</strong>).</p>
</div>
<div id="sample-size-calculation-for-difference-between-two-independent-proportions" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Sample size calculation for difference between two independent proportions<a href="sample-size-estimation.html#sample-size-calculation-for-difference-between-two-independent-proportions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To do the problem discussed in Worked Example 10.3, we use the <code>epi.sscohortc</code> function:</p>
<pre><code>epi.sscohortc(irexp1, irexp0, pexp = NA, n = NA, power = 0.80, 
   r = 1, N, design = 1, sided.test = 2, finite.correction = FALSE, 
   nfractional = FALSE, conf.level = 0.95)</code></pre>
<p>We can enter:</p>
<ul>
<li>irexp1: the assumed risk of the outcome in the exposed group: here 0.35</li>
<li>irexp0: the assumed risk of the outcome in the unexposed group: here 0.2</li>
<li>n: the total sample size, to be determined</li>
<li>power: the required power: here 0.8 (representing 80%)</li>
</ul>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="sample-size-estimation.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.sscohortc</span>(<span class="at">irexp1=</span><span class="fl">0.35</span>, <span class="at">irexp0=</span><span class="fl">0.2</span>, <span class="at">n=</span><span class="cn">NA</span>, <span class="at">power=</span><span class="fl">0.8</span>) </span></code></pre></div>
<pre><code>## $n.total
## [1] 276
## 
## $n.exp1
## [1] 138
## 
## $n.exp0
## [1] 138
## 
## $power
## [1] 0.8
## 
## $irr
## [1] 1.75
## 
## $or
## [1] 2.153846</code></pre>
<p>Note: It doesn’t matter if you swap the proportions for the <strong>exposed</strong> and <strong>unexposed</strong> groups, i.e. the command <code>epi.sscohortc(irexp1=0.2, irexp0=0.35, n=NA, power=0.8)</code> gives the same results.</p>
</div>
<div id="sample-size-calculation-with-a-relative-risk" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Sample size calculation with a relative risk<a href="sample-size-estimation.html#sample-size-calculation-with-a-relative-risk" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>epiR</code> package does not have a function to estimate sample size and power directly for a relative risk, but we can use the <code>epi.sscohortc</code> function. To do this, we recognise that the assumed rate in the exposed group will equal the rate in the unexposed group multiplied by the relative risk.</p>
<p>Here we will replicate Output 10.4, where p0=0.5 and the desired relative risk to detect is 1.5. So we specify <code>irexp0 = 0.5</code> and <code>irexp1 = 1.5 * 0.5</code>:</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="sample-size-estimation.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.sscohortc</span>(<span class="at">irexp1=</span><span class="fl">1.5</span><span class="sc">*</span><span class="fl">0.5</span>, <span class="at">irexp0=</span><span class="fl">0.5</span>, <span class="at">n=</span><span class="cn">NA</span>, <span class="at">power=</span><span class="fl">0.9</span>)</span></code></pre></div>
<pre><code>## $n.total
## [1] 154
## 
## $n.exp1
## [1] 77
## 
## $n.exp0
## [1] 77
## 
## $power
## [1] 0.9
## 
## $irr
## [1] 1.5
## 
## $or
## [1] 3</code></pre>
<p>Hence we require 77 participants in each group, or 154 participants in total.</p>
</div>
<div id="sample-size-calculation-with-an-odds-ratio" class="section level2 hasAnchor" number="10.5">
<h2><span class="header-section-number">10.5</span> Sample size calculation with an odds ratio<a href="sample-size-estimation.html#sample-size-calculation-with-an-odds-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can use the <code>epi.sscc</code> function to calculate a sample size based on an odds ratio in a case-control study:</p>
<pre><code>epi.sscc(OR, p1 = NA, p0, n, power, r = 1, 
   phi.coef = 0, design = 1, sided.test = 2, nfractional = FALSE, 
   conf.level = 0.95, method = &quot;unmatched&quot;, fleiss = FALSE)</code></pre>
<p>Using information from Worked Example 10.4, we specify:</p>
<ul>
<li>OR: the odds ratio to be detected, here 1.5</li>
<li>p0: the proportion of the outcome in the controls, here 0.5</li>
<li>n: the sample size, here to be calculated</li>
<li>power: the required study power, here 0.9</li>
</ul>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="sample-size-estimation.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.sscc</span>(<span class="at">OR=</span><span class="fl">1.5</span>, <span class="at">p0=</span><span class="fl">0.5</span>, <span class="at">n=</span><span class="cn">NA</span>, <span class="at">power=</span><span class="fl">0.9</span>)</span></code></pre></div>
<pre><code>## $n.total
## [1] 1038
## 
## $n.case
## [1] 519
## 
## $n.control
## [1] 519
## 
## $power
## [1] 0.9
## 
## $OR
## [1] 1.5</code></pre>
<p>Now we calculate the sample size for Worked Example 10.5:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="sample-size-estimation.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.sscc</span>(<span class="at">OR=</span><span class="dv">2</span>, <span class="at">p0=</span><span class="fl">0.3</span>, <span class="at">n=</span><span class="cn">NA</span>, <span class="at">power=</span><span class="fl">0.9</span>)</span></code></pre></div>
<pre><code>## $n.total
## [1] 376
## 
## $n.case
## [1] 188
## 
## $n.control
## [1] 188
## 
## $power
## [1] 0.9
## 
## $OR
## [1] 2</code></pre>
<p>Here we see that we require a total of 376 participants to detect an odds ratio of 2.0 with 90% power;</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="sample-size-estimation.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.sscc</span>(<span class="at">OR=</span><span class="dv">2</span>, <span class="at">p0=</span><span class="fl">0.3</span>, <span class="at">n=</span><span class="cn">NA</span>, <span class="at">power=</span><span class="fl">0.8</span>)</span></code></pre></div>
<pre><code>## $n.total
## [1] 282
## 
## $n.case
## [1] 141
## 
## $n.control
## [1] 141
## 
## $power
## [1] 0.8
## 
## $OR
## [1] 2</code></pre>
<p>or a total of 282 participants to detect an odds ratio of 2.0 with 80% power.</p>
</div>
<div id="estimating-sample-sizes-with-unequal-groups" class="section level2 hasAnchor" number="10.6">
<h2><span class="header-section-number">10.6</span> Estimating sample sizes with unequal groups<a href="sample-size-estimation.html#estimating-sample-sizes-with-unequal-groups" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To change the allocation ratio in any of these study type, we can specify <code>r</code>. Note that the definition of <code>r</code> differs slightly depending on the function used, so it pays to check the help-file for each function. In summary:</p>
<ul>
<li>for <code>epi.sscompc()</code>, <code>r</code> is the number in the treatment group divided by the number in the control group</li>
<li>for <code>epi.sscohortc()</code>, <code>r</code> is the number in the exposed group divided by the number in the unexposed group</li>
<li>for <code>epi.sscc()</code>, <code>r</code> is the number in the control group divided by the number in the case group</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="analysing-non-normal-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["phcm9795-R-notes.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
